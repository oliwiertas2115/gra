<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Brawl Clicker: Trophy Road Update</title>
    <style>
        :root {
            --yellow: #ffcb05; --blue: #0070ff; --purple: #a330ff; --green: #44ee44; --red: #ff4444; --orange: #ff8800;
        }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            font-family: 'Arial Black', sans-serif; background: #000; color: white; overflow: hidden;
        }

        /* --- T≈ÅO LOBBY --- */
        .view { height: 100vh; width: 100vw; display: flex; flex-direction: column; background: radial-gradient(circle, #0051ff, #001a4d); }
        .hidden { display: none !important; }

        /* --- TOP BAR --- */
        .top-nav { display: flex; justify-content: space-around; padding: 10px; background: rgba(0,0,0,0.8); border-bottom: 3px solid white; z-index: 10; }
        .stat { background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 20px; border: 2px solid #fff; font-size: 14px; display: flex; align-items: center; gap: 5px; }

        /* --- ALEJA PUCHAR√ìW (SCROLLOWANA W BOK) --- */
        #v-road { background: #003399; }
        .road-container {
            flex: 1; display: flex; align-items: center; overflow-x: auto; padding: 0 50px;
            gap: 20px; scroll-behavior: smooth;
        }
        .road-item {
            min-width: 140px; height: 200px; background: rgba(255,255,255,0.1);
            border-radius: 20px; border: 4px solid #fff; display: flex; flex-direction: column;
            align-items: center; justify-content: space-around; position: relative;
        }
        .road-item.unlocked { background: var(--orange); }
        .road-item.claimed { opacity: 0.6; filter: grayscale(0.8); }
        .road-marker { position: absolute; bottom: -30px; font-size: 18px; color: var(--yellow); }

        /* --- PRZYCISKI --- */
        .btn-main { 
            background: linear-gradient(#ffdf00, #ff8800); border: 4px solid white; 
            padding: 15px 30px; border-radius: 40px; font-size: 18px; cursor: pointer; color: black;
            box-shadow: 0 6px 0 #996600; text-transform: uppercase;
        }
        .btn-claim { padding: 5px 15px; font-size: 12px; background: var(--green); box-shadow: 0 3px 0 #006600; }

        /* --- ANIMACJE WALKI --- */
        #game-canvas { background: #1b5e20; width: 100%; height: 100%; touch-action: none; }
        .damage-popup {
            position: absolute; color: white; font-weight: bold; font-size: 30px;
            pointer-events: none; animation: floatUp 0.5s ease-out forwards;
            text-shadow: 2px 2px #000;
        }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-100px); opacity: 0; } }

        /* --- LOBBY CONTENT --- */
        .hero-section { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .hero-img { font-size: 130px; filter: drop-shadow(0 0 20px gold); animation: bounce 2s infinite ease-in-out; }
        @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

    </style>
</head>
<body>

    <div class="top-nav">
        <div class="stat">üèÜ <span id="t-val">0</span></div>
        <div class="stat">üí∞ <span id="c-val">0</span></div>
        <div class="stat">üíé <span id="g-val">0</span></div>
    </div>

    <div id="v-lobby" class="view">
        <div class="hero-section">
            <div id="hero-icon" class="hero-img">ü§†</div>
            <h1 id="hero-name" style="margin: 10px;">SHELLY</h1>
            <div style="background: var(--purple); padding: 5px 20px; border-radius: 15px; border: 2px solid white;">POZIOM MOCY <span id="p-val">1</span></div>
        </div>
        <div style="display: flex; gap: 10px; padding: 20px; justify-content: center;">
            <button class="btn-main" onclick="switchView('v-road')">ALEJA</button>
            <button class="btn-main" onclick="alert('Sklep wkr√≥tce!')">SKLEP</button>
        </div>
        <button class="btn-main" style="padding: 25px 100px; font-size: 30px; margin-bottom: 30px;" onclick="startGame()">GRAJ</button>
    </div>

    <div id="v-road" class="view hidden">
        <h1 style="text-align: center; margin-top: 20px;">ALEJA PUCHAR√ìW</h1>
        <div class="road-container" id="road-items">
            </div>
        <div style="padding: 30px; text-align: center;">
            <button class="btn-main" onclick="switchView('v-lobby')">POWR√ìT</button>
        </div>
    </div>

    <div id="v-game" class="view hidden">
        <canvas id="game-canvas"></canvas>
        <div id="battle-ui" style="position: absolute; bottom: 40px; width: 100%; display: flex; justify-content: center; gap: 40px;">
            <button class="btn-main" style="background: var(--red); width: 100px; height: 100px; border-radius: 50%;" onclick="attack()">ATAK</button>
        </div>
    </div>

    <script>
        // --- DANE ---
        let state = {
            trophies: 0, coins: 50, gems: 0, power: 1,
            claimedRoad: []
        };

        // Generujemy 50 nagr√≥d na Alejƒô
        const roadRewards = [];
        for(let i=1; i<=50; i++) {
            roadRewards.push({
                id: i,
                trophies: i * 50,
                reward: i % 5 === 0 ? "5 GEMS" : "100 COINS",
                type: i % 5 === 0 ? "gems" : "coins",
                val: i % 5 === 0 ? 5 : 100,
                icon: i % 5 === 0 ? "üíé" : "üí∞"
            });
        }

        // --- SILNIK GRY ---
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        let isGaming = false;
        let enemy = { x: 0, y: 0, hp: 100, maxHp: 100 };

        function startGame() {
            isGaming = true;
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            enemy.maxHp = 100 + (state.trophies * 2);
            enemy.hp = enemy.maxHp;
            enemy.x = canvas.width / 2;
            enemy.y = canvas.height / 2;
            switchView('v-game');
            gameLoop();
        }

        function gameLoop() {
            if(!isGaming) return;
            ctx.clearRect(0,0, canvas.width, canvas.height);
            
            // Gracz (uproszczony)
            ctx.font = "60px Arial";
            ctx.fillText("ü§†", 50, canvas.height - 100);

            // Przeciwnik
            ctx.font = "80px Arial";
            ctx.fillText("ü§ñ", enemy.x - 40, enemy.y + 30);

            // Pasek ≈ºycia
            ctx.fillStyle = "#333";
            ctx.fillRect(enemy.x - 50, enemy.y - 70, 100, 10);
            ctx.fillStyle = "lime";
            ctx.fillRect(enemy.x - 50, enemy.y - 70, (enemy.hp/enemy.maxHp)*100, 10);

            requestAnimationFrame(gameLoop);
        }

        function attack() {
            let dmg = 20 * state.power;
            enemy.hp -= dmg;
            createPopup(enemy.x, enemy.y, dmg);

            if(enemy.hp <= 0) {
                isGaming = false;
                state.trophies += 10;
                state.coins += 15;
                alert("ZWYCIƒòSTWO! +10üèÜ");
                switchView('v-lobby');
                updateUI();
            }
        }

        function createPopup(x, y, d) {
            let p = document.createElement('div');
            p.className = 'damage-popup';
            p.innerText = d;
            p.style.left = x + "px";
            p.style.top = y + "px";
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 500);
        }

        // --- UI ---
        function switchView(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'v-road') renderRoad();
        }

        function renderRoad() {
            const container = document.getElementById('road-items');
            container.innerHTML = "";
            roadRewards.forEach((r, index) => {
                let unlocked = state.trophies >= r.trophies;
                let claimed = state.claimedRoad.includes(r.id);
                
                let card = document.createElement('div');
                card.className = `road-item ${unlocked ? 'unlocked' : ''} ${claimed ? 'claimed' : ''}`;
                card.innerHTML = `
                    <div style="font-size: 40px;">${r.icon}</div>
                    <div style="font-size: 12px; text-align: center;">${r.reward}</div>
                    ${unlocked && !claimed ? `<button class="btn-main btn-claim" onclick="claimReward(${r.id}, '${r.type}', ${r.val})">ODBIERZ</button>` : ""}
                    <div class="road-marker">${r.trophies}üèÜ</div>
                `;
                container.appendChild(card);
            });
        }

        function claimReward(id, type, val) {
            if(type === 'coins') state.coins += val;
            if(type === 'gems') state.gems += val;
            state.claimedRoad.push(id);
            updateUI();
            renderRoad();
        }

        function updateUI() {
            document.getElementById('t-val').innerText = state.trophies;
            document.getElementById('c-val').innerText = state.coins;
            document.getElementById('g-val').innerText = state.gems;
            document.getElementById('p-val').innerText = state.power;
            save();
        }

        // --- ZAPIS ---
        function save() { localStorage.setItem('brawl_v4_save', JSON.stringify(state)); }
        function load() {
            let s = localStorage.getItem('brawl_v4_save');
            if(s) state = JSON.parse(s);
            updateUI();
        }

        window.onload = load;
    </script>
</body>
</html>
