<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Brawl Clicker Ultra</title>
    <style>
        :root {
            --brawl-blue: #0070ff;
            --brawl-yellow: #ffcb05;
            --brawl-green: #44ee44;
            --brawl-red: #ff4444;
            --dark-glass: rgba(0, 0, 0, 0.7);
        }

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            font-family: 'Arial Black', sans-serif; background: #002d72;
            color: white; overflow: hidden; touch-action: manipulation;
        }

        /* --- LOGOWANIE / PROFIL --- */
        #login-screen {
            position: fixed; z-index: 1000; width: 100%; height: 100%;
            background: var(--brawl-blue); display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }

        /* --- TOP BAR --- */
        .top-bar {
            height: 60px; background: var(--dark-glass); display: flex;
            justify-content: space-around; align-items: center; border-bottom: 3px solid white;
        }

        /* --- LOBBY --- */
        .view { height: calc(100vh - 60px); width: 100%; display: flex; flex-direction: column; align-items: center; }
        .hidden { display: none !important; }

        .brawler-preview {
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .avatar-circle {
            width: 180px; height: 180px; background: var(--brawl-yellow);
            border: 8px solid white; border-radius: 50%; font-size: 100px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 30px rgba(255, 203, 5, 0.5);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        /* --- BUTTONS --- */
        .main-btn {
            background: linear-gradient(#ffdf00, #ff8800);
            border: 4px solid white; border-radius: 40px; padding: 15px 50px;
            font-size: 24px; color: black; box-shadow: 0 6px 0 #996600;
            margin: 10px; cursor: pointer; text-transform: uppercase;
        }

        .play-btn { width: 80%; font-size: 32px; background: linear-gradient(#ffff00, #ffaa00); }

        /* --- BATTLE --- */
        #battle-field { position: relative; flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .enemy-emoji { font-size: 120px; cursor: pointer; transition: transform 0.05s; }
        .enemy-emoji:active { transform: scale(0.8); }
        
        .hp-container { width: 80%; height: 25px; background: #333; border: 3px solid white; border-radius: 20px; overflow: hidden; margin-bottom: 20px; }
        .hp-bar { height: 100%; background: var(--brawl-green); width: 100%; transition: width 0.1s; }

        /* --- ALEJA I KARNET --- */
        .list-container { width: 90%; height: 70%; background: rgba(0,0,0,0.5); border-radius: 20px; overflow-y: auto; padding: 15px; }
        .item-card { 
            background: #444; margin-bottom: 10px; padding: 15px; border-radius: 15px;
            display: flex; justify-content: space-between; align-items: center; border: 2px solid #666;
        }
        .item-card.unlocked { border-color: var(--brawl-yellow); background: #555; }
        
        /* --- POWIADOMIENIA --- */
        .dmg-text { position: absolute; color: yellow; font-size: 40px; font-weight: bold; pointer-events: none; animation: flyUp 0.6s ease-out forwards; }
        @keyframes flyUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1>BRAWL CLICKER</h1>
        <input type="text" id="username" placeholder="Twoje imiƒô..." style="padding: 15px; border-radius: 10px; border: none; font-size: 18px;">
        <button class="main-btn" onclick="login()">ZALOGUJ SIƒò</button>
    </div>

    <div class="top-bar">
        <div>üèÜ <span id="t-count">0</span></div>
        <div>üí∞ <span id="c-count">0</span></div>
        <div id="player-tag" style="font-size: 12px; color: #aaa;">#GRACZ</div>
    </div>

    <div id="v-lobby" class="view hidden">
        <div class="brawler-preview">
            <div class="avatar-circle">ü§†</div>
            <h2 id="display-name">Gracz</h2>
            <div style="background: var(--brawl-green); padding: 5px 20px; border-radius: 10px;">MOC: <span id="p-lvl">1</span></div>
            <button onclick="upgrade()" style="margin-top: 10px; background: #ffaa00; border: none; padding: 10px; border-radius: 5px; cursor: pointer;">ULEPSZ ZA 50 üí∞</button>
        </div>
        <div style="display: flex; width: 100%; justify-content: space-around;">
            <button class="main-btn" style="font-size: 14px; padding: 10px;" onclick="switchView('v-road')">ALEJA</button>
            <button class="main-btn" style="font-size: 14px; padding: 10px;" onclick="switchView('v-pass')">KARNET</button>
        </div>
        <button class="main-btn play-btn" onclick="startBattle()">ZAGRAJ</button>
    </div>

    <div id="v-battle" class="view hidden">
        <div id="battle-field">
            <div class="hp-container"><div id="hp-bar" class="hp-bar"></div></div>
            <div class="enemy-emoji" onclick="hit(event)">ü§ñ</div>
            <h3 id="enemy-name">ROBOT BOSS</h3>
        </div>
        <button class="main-btn" style="background: var(--brawl-red);" onclick="quitBattle()">UCIEKNIJ</button>
    </div>

    <div id="v-road" class="view hidden">
        <h2>ALEJA PUCHAR√ìW</h2>
        <div class="list-container" id="road-list"></div>
        <button class="main-btn" onclick="switchView('v-lobby')">POWR√ìT</button>
    </div>

    <div id="v-pass" class="view hidden">
        <h2>BRAWL PASS</h2>
        <div class="list-container" id="pass-list"></div>
        <button class="main-btn" onclick="switchView('v-lobby')">POWR√ìT</button>
    </div>

    <script>
        let player = {
            name: "", trophies: 0, coins: 0, power: 1, 
            claimedRoad: [], claimedPass: []
        };

        let currentHP = 0, maxHP = 0;

        // 1. Logowanie
        function login() {
            let name = document.getElementById('username').value;
            if (name.length < 2) return alert("Za kr√≥tkie imiƒô!");
            player.name = name;
            document.getElementById('display-name').innerText = name;
            document.getElementById('player-tag').innerText = "#" + Math.floor(Math.random()*9999);
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('v-lobby').classList.remove('hidden');
            loadData();
            updateUI();
        }

        // 2. Nawigacja
        function switchView(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'v-road') renderRoad();
            if(id === 'v-pass') renderPass();
        }

        // 3. Walka
        function startBattle() {
            maxHP = 100 + (player.trophies * 5);
            currentHP = maxHP;
            updateHP();
            switchView('v-battle');
        }

        function hit(e) {
            let dmg = 10 * player.power;
            currentHP -= dmg;
            
            // Animacja cyferek
            let text = document.createElement('div');
            text.className = 'dmg-text';
            text.innerText = "-" + dmg;
            text.style.left = e.clientX + "px";
            text.style.top = e.clientY + "px";
            document.body.appendChild(text);
            setTimeout(() => text.remove(), 600);

            // Dr≈ºenie wroga
            e.target.style.transform = "scale(0.8) rotate(10deg)";
            setTimeout(() => e.target.style.transform = "scale(1)", 50);

            updateHP();
            if (currentHP <= 0) win();
        }

        function updateHP() {
            let p = (currentHP / maxHP) * 100;
            document.getElementById('hp-bar').style.width = p + "%";
        }

        function win() {
            player.trophies += 10;
            player.coins += 20;
            alert("ZWYCIƒòSTWO! +10üèÜ");
            updateUI();
            switchView('v-lobby');
        }

        function quitBattle() {
            let loss = Math.floor(Math.random() * 6) + 1;
            player.trophies = Math.max(0, player.trophies - loss);
            alert("PRZEGRANA! Straci≈Çe≈õ " + loss + "üèÜ");
            updateUI();
            switchView('v-lobby');
        }

        // 4. Ulepszenia
        function upgrade() {
            if (player.coins >= 50) {
                player.coins -= 50;
                player.power++;
                updateUI();
                alert("ULEPSZONO! Twoja si≈Ça to teraz: " + player.power);
            } else {
                alert("Za ma≈Ço monet!");
            }
        }

        // 5. Aleja i Karnet
        function renderRoad() {
            let list = document.getElementById('road-list');
            list.innerHTML = "";
            let rewards = [
                {t: 20, gift: "50 Monet", type: "c", val: 50},
                {t: 100, gift: "Nowy Avatar üé≠", type: "a", val: "üé≠"},
                {t: 500, gift: "Mega Paka", type: "c", val: 500}
            ];

            rewards.forEach((r, i) => {
                let canClaim = player.trophies >= r.t && !player.claimedRoad.includes(i);
                list.innerHTML += `
                    <div class="item-card ${player.trophies >= r.t ? 'unlocked' : ''}">
                        <div><b>${r.t}üèÜ</b><br>${r.gift}</div>
                        ${canClaim ? `<button onclick="claimRoad(${i}, ${r.val}, '${r.type}')">ODBIERZ</button>` : ""}
                    </div>`;
            });
        }

        function claimRoad(i, val, type) {
            if (type === 'c') player.coins += val;
            player.claimedRoad.push(i);
            updateUI();
            renderRoad();
        }

        function renderPass() {
            let list = document.getElementById('pass-list');
            list.innerHTML = "<p>ZBIERAJ PUCHARY, BY ODBLOKOWAƒÜ</p>";
            // Podobna logika do Alei
        }

        function updateUI() {
            document.getElementById('t-count').innerText = player.trophies;
            document.getElementById('c-count').innerText = player.coins;
            document.getElementById('p-lvl').innerText = player.power;
            saveData();
        }

        // 6. Zapis
        function saveData() { localStorage.setItem('brawl_player', JSON.stringify(player)); }
        function loadData() {
            let d = localStorage.getItem('brawl_player');
            if(d) {
                let p = JSON.parse(d);
                if(p.name === player.name) player = p;
            }
        }
    </script>
</body>
</html>
